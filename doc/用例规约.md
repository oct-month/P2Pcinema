# P2Pcinema -- 用例规约

## 1、创建房间

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 创建房间                                                     |
| 用例描述       | 用户设定好房间密码，开启房间，然后进入等待连接状态           |
| 执行者         | 房主                                                         |
| 前置条件       | 1、用户登陆了此系统<br />2、用户的系统没有进入房间           |
| 后置条件       | 1、服务器记录了用户的房间信息<br />2、服务器上的房间状态设置为“等待”<br />2、用户作为房主进入房间，并等待访客的连接 |
| 主过程描述     | 1、用户设定好房间密码<br />2、用户点击创建房间按钮<br />3、如果一切正常，系统直接进入房间<br />4、如果连接异常，系统显示错误信息 |
| 业务规则       | 房主的房间在同一时刻只能有一个访客，房间号固定为房主的ID     |
| 涉及的业务实体 | 虚拟房间、服务器                                             |

## 2、加入房间

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 加入房间                                                     |
| 用例描述       | 用户输入房间号和密码，进入房间                               |
| 执行者         | 访客                                                         |
| 前置条件       | 1、用户登陆了此系统<br />2、用户的系统没有进入房间<br />3、服务器上有目标房间的信息<br />4、目标房间没有其他访客（服务器上的房间状态为“等待”） |
| 后置条件       | 1、用户和房主建立了连接<br />2、用户作为访客进入房主的房间<br />3、服务器上的房间状态设置为“已满” |
| 主过程描述     | 1、用户输入房间号和密码<br />2、用户点击连接按钮<br />3、如果一切正常，系统直接进入房间<br />4、如果连接异常，系统显示错误信息<br />5、如果目标房间有其他访客，系统显示“房间已满” |
| 业务规则       | 同一时刻，访客只能进入一个房间                               |
| 涉及的业务实体 | 虚拟房间、服务器                                             |

## 3、退出房间

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 退出房间                                                     |
| 用例描述       | 用户离开房间，断开和房主的连接                               |
| 执行者         | 访客                                                         |
| 前置条件       | 1、用户已作为访客进入房间                                    |
| 后置条件       | 1、用户离开房间<br />2、服务器上的房间状态设置为“等待”       |
| 主过程描述     | 1、用户点击离开按钮<br />2、用户主机关闭和房主的连接<br />3、用户回到系统主界面 |
| 业务规则       |                                                              |
| 涉及的业务实体 | 虚拟房间、服务器                                             |

## 4、关闭房间

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 关闭房间                                                     |
| 用例描述       | 用户关闭房间，房主和访客都离开房间                           |
| 执行者         | 房主                                                         |
| 前置条件       | 1、用户已作为房主进入房间                                    |
| 后置条件       | 1、房主和访客都离开房间<br />2、服务器删除该房间信息         |
| 主过程描述     | 1、用户点击关闭房间按钮<br />2、用户主机关闭和访客的连接<br />3、访客收到离开信息，也断开连接<br />4、用户回到系统主界面 |
| 业务规则       |                                                              |
| 涉及的业务实体 | 虚拟房间、服务器                                             |

## 5、发送和接收聊天消息

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 发送和接收聊天消息                                           |
| 用例描述       | 房主或访客在聊天窗口发送并接收文字消息                       |
| 执行者         | 房主、访客                                                   |
| 前置条件       | 1、房主已进入房间<br />2、访客也已经进入房间                 |
| 后置条件       | 1、发出的消息显示在聊天窗口中（包括发送人和发送时间）        |
| 主过程描述     | 1、用户在聊天输入框中键入消息<br />2、用户点击发送按钮发送消息<br />3、聊天窗口中显示自己发出的消息和收到的消息<br />4、发送人显示为自己的昵称、发送时间为发送方发出消息的时间 |
| 业务规则       | 只要在房间内，就能发送消息。用户不会收到进入房间之前的消息。 |
| 涉及的业务实体 | 聊天输入框、聊天窗口、消息、虚拟房间                         |

## 6、播放视频

| 规约属性       | 规约属性描述                                                 |
| -------------- | ------------------------------------------------------------ |
| 用例名称       | 播放视频                                                     |
| 用例描述       | 用户自由选择视频播放，自由拖放视频进度                       |
| 执行者         | 房主                                                         |
| 前置条件       | 1、用户已作为房主进入房间                                    |
| 后置条件       | 1、房间显示屏开始播放所选择的视频<br />2、视频跳转到用户设定的进度位置<br />2、访客的系统也同步播放视频 |
| 主过程描述     | 1、用户选择视频，双击播放<br />2、显示屏下方有进度条，用户可以拖动改变视频进度<br />3、显示屏上的内容会同步到访客 |
| 业务规则       | 房主可以在没有访客的时候播放视频。访客的显示屏会和房主保持同步。 |
| 涉及的业务实体 | 显示屏、视频、进度条、虚拟房间                               |



